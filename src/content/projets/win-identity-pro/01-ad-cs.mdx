---
title: "PKI : DÃ©ploiement du rÃ´le AD CS"
description: "Mise en place dâ€™une autoritÃ© de certification dâ€™entreprise pour Ã©tablir la confiance numÃ©rique au sein du domaine."
tags: ["Active Directory", "SÃ©curitÃ©", "Audit"]
category: "windows"
pubDate: 2026-01-30
slug: "ad-cs"
---

import SeriesStepper from '../../../components/SeriesStepper.astro';
import { WIN_IDENTITY_PRO } from '../../../constants/series';
import NextStep from '../../../components/NextStep.astro';

<SeriesStepper 
  seriesTitle="Certificat AD CS" 
  steps={WIN_IDENTITY_PRO} 
  currentStepIndex={1} 
/>

Lâ€™**Active Directory Certificate Services (AD CS)** constitue la fondation de la confiance numÃ©rique dâ€™un environnement Windows.  
Dans cette Ã©tape du lab, lâ€™objectif nâ€™est pas seulement dâ€™installer une autoritÃ© de certification, mais de poser une **racine de confiance propre, maÃ®trisÃ©e et durcie**, capable de supporter les futurs besoins : authentification forte, LDAPS, chiffrement des services et authentification machine.

Le dÃ©ploiement d'une **PKI (Public Key Infrastructure)** est donc abordÃ© ici avec une logique de **sÃ©curitÃ©, de traÃ§abilitÃ© et de moindre privilÃ¨ge**.

---

## ğŸ—ï¸ Ã‰tape 1 : Installer le rÃ´le

Je commence par ajouter le rÃ´le **Services de certificats Active Directory** depuis le Gestionnaire de serveur.  
Lâ€™objectif est de rester sur une **installation minimale** :


- Je sÃ©lectionne uniquement **AutoritÃ© de certification**
- Je **nâ€™active pas lâ€™inscription Web** afin dâ€™Ã©viter dâ€™installer IIS et dâ€™augmenter la surface dâ€™attaque du serveur

Avant de lancer la configuration, je vÃ©rifie que le **nom DNS du serveur est dÃ©finitif**, car il sera inscrit dans les certificats Ã©mis par la CA.

> â— Une autoritÃ© de certification ne doit pas changer dâ€™identitÃ© rÃ©seau aprÃ¨s son dÃ©ploiement.

<div class="grid grid-cols-1 md:grid-cols-2 gap-4 my-8">
  <div class="flex flex-col items-center">
      <img src="/images/projets/win-identity-pro/ad-cs/install-adcs.png" alt="Installation du rÃ´le AD CS" class="rounded-lg border border-white/10 shadow-md" /> 
      <p class="text-[0.65rem] italic opacity-50 mt-2">SÃ©lection du rÃ´le AutoritÃ© de certification.</p>
  </div>
    <div class="flex flex-col items-center">
      <img src="/images/projets/win-identity-pro/ad-cs/install-ca.png" alt="Installation minimale" class="rounded-lg border border-white/10 shadow-md" /> 
      <p class="text-[0.65rem] italic opacity-50 mt-2">Installation sans service Web pour rÃ©duire lâ€™exposition.</p>
  </div>
</div>

---

## ğŸ” Ã‰tape 2 : Configurer lâ€™AutoritÃ© de Certification

Je dÃ©ploie une **AutoritÃ© de certification dâ€™entreprise racine**, intÃ©grÃ©e Ã  Active Directory.  
Ce choix permet plus tard :

- lâ€™**auto-enrÃ´lement** via GPO  
- lâ€™approbation automatique des certificats pour les modÃ¨les autorisÃ©s  

Je gÃ©nÃ¨re ensuite une **nouvelle clÃ© privÃ©e RSA 4096 bits** avec un algorithme de hachage **SHA512**, dans une logique de durcissement cryptographique au-delÃ  du minimum recommandÃ© (SHA256 restant le standard courant).

<div class="grid grid-cols-1 md:grid-cols-2 gap-4 my-8">
  <div class="flex flex-col items-center">
    <img src="/images/projets/win-identity-pro/ad-cs/adcs-4.png" alt="ClÃ© privÃ©e" class="rounded-lg border border-white/10 shadow-md" />
    <p class="text-[0.65rem] italic opacity-50 mt-2">CrÃ©ation d'une nouvelle clÃ© privÃ©e sÃ©curisÃ©e.</p>
  </div>
  <div class="flex flex-col items-center">
    <img src="/images/projets/win-identity-pro/ad-cs/adcs-fin.png" alt="RÃ©sumÃ© final" class="rounded-lg border border-white/10 shadow-md" />
    <p class="text-[0.65rem] italic opacity-50 mt-2">Confirmation de la configuration rÃ©ussie</p>
  </div>
</div>

---

## ğŸ›¡ï¸ Ã‰tape 3 : Segmenter lâ€™administration de la PKI (Moindre privilÃ¨ge)

Administrer une PKI avec un compte **Domain Admin** crÃ©erait un point de compromission critique.  
Je mets donc en place une **identitÃ© dâ€™exploitation dÃ©diÃ©e** : **`adm-pki`**.

### ğŸ‘¤ CrÃ©ation du compte dâ€™administration PKI

Le compte est :

- isolÃ© dans une OU dÃ©diÃ©e aux comptes dâ€™administration :  
  **`00_ADMINS > PKI`**
- utilisÃ© uniquement pour lâ€™exploitation quotidienne de lâ€™autoritÃ© de certification

Cette sÃ©paration permet dâ€™identifier clairement les actions PKI dans les journaux et de limiter les risques en cas de compromission.

<div class="grid grid-cols-1 md:grid-cols-2 gap-4 my-8">
  <div class="flex flex-col items-center">
    <img src="/images/projets/win-identity-pro/ad-cs/adm-pki.png" alt="CrÃ©ation du compte adm-pki" class="rounded-lg border border-white/10 shadow-md" />
    <p class="text-[0.65rem] italic opacity-50 mt-2">CrÃ©ation du compte dâ€™administration dÃ©diÃ© Ã  la PKI, isolÃ© dans son groupe</p>
  </div>
  <div class="flex flex-col items-center">
    <img src="/images/projets/win-identity-pro/ad-cs/adm-pki2.png" alt="OU PKI" class="rounded-lg border border-white/10 shadow-md" />
    <p class="text-[0.65rem] italic opacity-50 mt-2">Attribution des groupes nÃ©cÃ©ssaires uniquement</p>
  </div>
</div>

---

### ğŸ“œ Gestion du groupe **Editeurs de certificats**

Le groupe **Ã‰diteurs de certificats** permet de publier des certificats dans Active Directory (attributs des objets utilisateurs et ordinateurs).

Dans une configuration par dÃ©faut, le **compte machine du serveur CA** peut en Ãªtre membre.  
Ici, je fais le choix dâ€™un modÃ¨le plus strict :

- ğŸ”» Retrait du compte machine **`SRV-AD-01$`**
- â• Ajout exclusif du compte **`adm-pki`**

ğŸ‘‰ Cela permet que la publication des certificats dans lâ€™annuaire soit rÃ©alisÃ©e par une **identitÃ© nominative** plutÃ´t que par un compte machine, ce qui amÃ©liore la traÃ§abilitÃ©. 

Ce choix relÃ¨ve dâ€™un **durcissement organisationnel**, et non dâ€™une obligation technique.
Depuis la console **`certsrv.msc`**, jâ€™ouvre les propriÃ©tÃ©s de lâ€™autoritÃ© puis lâ€™onglet **SÃ©curitÃ©** afin de dÃ©lÃ©guer uniquement les droits nÃ©cessaires au compte `adm-pki` :

- **Lire**
- **Ã‰mettre et gÃ©rer des certificats**

Ces permissions permettent la gestion quotidienne (Ã©mission, rÃ©vocation, suivi des demandes) sans autoriser de modifications structurelles.

<div class="grid grid-cols-1 md:grid-cols-2 gap-4 my-8">
  <div class="flex flex-col items-center">
    <img src="/images/projets/win-identity-pro/ad-cs/adm-pki3.png" alt="Membres du groupe Ã‰diteurs de certificats" class="rounded-lg border border-white/10 shadow-md" />
    <p class="text-[0.65rem] italic opacity-50 mt-2">Restriction des membres du groupe Certificate Publishers.</p>
  </div>
  <div class="flex flex-col items-center">
    <img src="/images/projets/win-identity-pro/ad-cs/adm-pki-cert.png" alt="Permissions de la CA" class="rounded-lg border border-white/10 shadow-md" />
    <p class="text-[0.65rem] italic opacity-50 mt-2">DÃ©lÃ©gation des droits dâ€™Ã©mission sur lâ€™autoritÃ© de certification.</p>
  </div>
</div>

---


### ğŸ” SÃ©paration des rÃ´les dâ€™administration

La gestion avancÃ©e de la PKI reste strictement limitÃ©e aux comptes **Tier 0**, notamment :

- modification de la configuration de la CA  
- gestion des modÃ¨les de certificats sensibles  
- maintenance de la hiÃ©rarchie de certification  

Ainsi, le compte **`adm-pki`** est un compte dâ€™**exploitation**, pas un compte dâ€™**architecture**.

> ğŸ¯ Cette sÃ©paration rÃ©duit fortement lâ€™impact potentiel dâ€™une compromission et sâ€™aligne avec les bonnes pratiques de sÃ©curisation des environnements Active Directory.

---

## ğŸ” Ã‰tape 4 : Activer lâ€™audit 

Une PKI sans journalisation fiable constitue un angle mort de sÃ©curitÃ©.  
Jâ€™active donc lâ€™audit des Ã©vÃ©nements de lâ€™autoritÃ© de certification en modifiant la GPO **DOM - S - Advanced_Auditing** pour activer lâ€™option " Auditer les services de certifications " :


AprÃ¨s application, la sous-catÃ©gorie **Services de certification** passe bien en **SuccÃ¨s et Ã‰chec**, que l'on peut vÃ©rifier directement via powershell.

<div class="grid grid-cols-1 md:grid-cols-2 gap-4 my-8">
  <div class="flex flex-col items-center">
    <img src="/images/projets/win-identity-pro/ad-cs/audit-cert.png" alt="Membres du groupe Ã‰diteurs de certificats" class="rounded-lg border border-white/10 shadow-md" />
    <p class="text-[0.65rem] italic opacity-50 mt-2">Auditer les succÃ¨s et Ã©checs.</p>
  </div>
  <div class="flex flex-col items-center">
    <img src="/images/projets/win-identity-pro/ad-cs/audit-pwshell-ok.png" alt="Permissions de la CA" class="rounded-lg border border-white/10 shadow-md" />
    <p class="text-[0.65rem] italic opacity-50 mt-2">VÃ©rification de l'audit avec la commande auditpol /get</p>
  </div>
</div>
---

## ğŸ§¬ Ã‰tape 5 : VÃ©rifier la publication de la PKI dans Active Directory

MÃªme sans crÃ©er de modÃ¨le personnalisÃ©, une autoritÃ© de certification **Enterprise** publie automatiquement des informations dans lâ€™annuaire.

Jâ€™utilise **ADSI Edit** pour vÃ©rifier que le **certificat de lâ€™autoritÃ© de certification** est bien publiÃ© dans la partition de configuration dâ€™Active Directory.

Chemin observÃ© :
`CN=Configuration â†’ CN=Services â†’ CN=Public Key Services â†’ CN=Certification Authorities`

La prÃ©sence de cet objet confirme que :
- la CA est correctement intÃ©grÃ©e Ã  Active Directory  
- les machines du domaine peuvent rÃ©cupÃ©rer le certificat racine automatiquement  
- la chaÃ®ne de confiance peut Ãªtre construite sans action manuelle

<div style="display: flex; justify-content: center; margin: 2rem 0;">
  <div style="display: flex; flex-direction: column; align-items: center; max-width: 700px;">
    <img src="/images/projets/win-identity-pro/ad-cs/cert-ad-inscrit.png" alt="Publication du certificat de la CA dans ADSI" style="width: 100%; height: auto; border-radius: 10px; border: 1px solid rgba(255,255,255,0.1);" />
    <p style="font-size: 0.7rem; text-align: center; opacity: 0.6; margin-top: 8px; font-style: italic;">Le certificat de lâ€™autoritÃ© de certification est bien publiÃ© dans Active Directory.</p>
  </div>
</div>

Cette vÃ©rification confirme que lâ€™infrastructure PKI est correctement ancrÃ©e dans lâ€™annuaire avant de passer aux Ã©tapes suivantes.

---

## âœ… Ã‰tape 6 : VÃ©rifier la santÃ© de la PKI

Pour terminer, jâ€™utilise **PKIView (`pkiview.msc`)** afin de contrÃ´ler :

- la hiÃ©rarchie de certification  
- la validitÃ© des certificats dâ€™autoritÃ©  
- la disponibilitÃ© des points **AIA** et **CDP**

Tous les indicateurs sont au vert : la chaÃ®ne de confiance est fonctionnelle et les points de distribution sont accessibles.

<div style="display: flex; justify-content: center; margin: 2rem 0;">
  <div style="display: flex; flex-direction: column; align-items: center; max-width: 450px;">
    <img src="/images/projets/win-identity-pro/ad-cs/pki-ok.png" alt="PKIview" style="width: 130%; height: auto; border-radius: 10px; border: 1px solid rgba(255,255,255,0.1);" />
    <p style="font-size: 0.65rem; text-align: center; opacity: 0.5; margin-top: 8px; font-style: italic;">Emplacement AIA et CDP du certificat OK</p>
  </div>
</div>

---

## ğŸ§© Ã‰tape 7 : VÃ©rifier le certificat via la console MMC

Une fois la PKI validÃ©e cÃ´tÃ© infrastructure, je vÃ©rifie que le **certificat de lâ€™autoritÃ© de certification** est bien installÃ© dans le magasin de certificats du serveur.

Pour cela, jâ€™utilise la **console MMC** afin dâ€™inspecter les certificats de lâ€™ordinateur local.

### ğŸ”§ Ajout du composant logiciel enfichable Certificats

1. Lancer `mmc.exe`
2. Menu **Fichier â†’ Ajouter/Supprimer un composant logiciel enfichable**
3. SÃ©lectionner **Certificats**, "ajouter"
4. Choisir **Compte dâ€™ordinateur**
5. SÃ©lectionner **Ordinateur local**

Cette manipulation permet dâ€™accÃ©der au magasin de certificats systÃ¨me, et non au magasin utilisateur.

<div class="grid grid-cols-1 md:grid-cols-2 gap-6 my-8">
  <img src="/images/projets/win-identity-pro/ad-cs/mmc1.png" alt="Ajout composant enfichable MMC" class="rounded-lg border border-white/10 shadow-md" />
  <img src="/images/projets/win-identity-pro/ad-cs/mmc2.png" alt="Choix du composant Certificats" class="rounded-lg border border-white/10 shadow-md" />
  <img src="/images/projets/win-identity-pro/ad-cs/mmc3.png" alt="SÃ©lection compte ordinateur" class="rounded-lg border border-white/10 shadow-md" />
  <img src="/images/projets/win-identity-pro/ad-cs/mmc4.png" alt="Ordinateur local" class="rounded-lg border border-white/10 shadow-md" />
</div>

---

### ğŸ” VÃ©rification du certificat de la CA

Une fois le composant ajoutÃ©, je navigue dans :

**Certificats (ordinateur local) â†’ AutoritÃ©s de certification racines de confiance â†’ Certificats**

Le certificat de mon autoritÃ© de certification dâ€™entreprise apparaÃ®t bien dans le magasin.  
Cela confirme que :

- la CA est correctement installÃ©e
- le certificat racine est bien approuvÃ© localement
- la chaÃ®ne de confiance peut fonctionner pour les services du serveur

<div style="display: flex; justify-content: center; margin: 2rem 0;">
  <div style="width: 100%; max-width: 900px; display: flex; flex-direction: column; align-items: center;">
    <img src="/images/projets/win-identity-pro/ad-cs/mmc5.png" alt="Certificat racine visible dans MMC" style="width: 100%; height: auto; border-radius: 10px; border: 1px solid rgba(255,255,255,0.1);" />
    <p style="font-size: 0.75rem; text-align: center; opacity: 0.5; margin-top: 8px; font-style: italic;">Le certificat de lâ€™autoritÃ© est bien prÃ©sent dans le magasin racine de confiance</p>
  </div>
</div>



Cette vÃ©rification cÃ´tÃ© systÃ¨me complÃ¨te les contrÃ´les PKIView : on valide Ã  la fois lâ€™infrastructure de confiance **et** sa prÃ©sence effective sur le serveur.



La PKI interne est dÃ©sormais **opÃ©rationnelle, segmentÃ©e et correctement auditÃ©e**.  
Elle constitue la **brique de confiance** nÃ©cessaire pour sÃ©curiser les flux critiques du domaine.

La prochaine Ã©tape consiste Ã  exploiter cette infrastructure pour chiffrer les communications LDAP via **LDAPS**.

<NextStep 
  title="SÃ©curisation LDAPS" 
  description="Utilisation de nos modÃ¨les pour chiffrer les Ã©changes de l'annuaire sur le port 636." 
  link="/projets/win-identity-pro/ldaps" 
/>
