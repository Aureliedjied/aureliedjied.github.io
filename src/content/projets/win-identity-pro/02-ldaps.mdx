---
title: "LDAPS : Chiffrement et audit des flux d'annuaire"
description: "S√©curisation des acc√®s LDAP via TLS et mise en place d'un audit de signature pour durcir l'infrastructure Active Directory."
tags: ["Active Directory", "S√©curit√©", "LDAPS", "Audit", "ANSSI"]
pubDate: 2026-02-05
category: "windows"
slug: "ldaps"
---

import SeriesStepper from '../../../components/SeriesStepper.astro';
import { WIN_IDENTITY_PRO } from '../../../constants/series';
import NextStep from '../../../components/NextStep.astro';

<SeriesStepper 
  seriesTitle="S√©curiser les Identit√©s" 
  steps={WIN_IDENTITY_PRO} 
  currentStepIndex={2} 
/>

Par d√©faut, les requ√™tes LDAP circulent en clair sur le r√©seau via le **port 389**.  
Cela expose potentiellement :

- des identifiants  
- des informations d‚Äôannuaire  
- des requ√™tes d‚Äôauthentification  

Dans une infrastructure durcie selon les recommandations de l‚Äô**ANSSI**, il est indispensable de prot√©ger ces √©changes.

Le passage au **LDAPS (LDAP over TLS ‚Äì port 636)** permet de chiffrer le canal de communication. Cette s√©curisation repose directement sur :

- la **PKI interne** d√©ploy√©e pr√©c√©demment  
- la **coh√©rence DNS**, n√©cessaire √† la validation du certificat du contr√¥leur de domaine  

Sans certificat valide c√¥t√© DC, le service LDAPS ne peut tout simplement pas fonctionner.

---

## üõ†Ô∏è √âtape 1 : Cr√©ation du mod√®le de certificat "Lab-DC-LDAPS"

Pour que LDAPS soit activ√©, le contr√¥leur de domaine doit disposer d‚Äôun certificat contenant l‚Äôusage **Authentification du serveur**.

Sur l‚Äôautorit√© de certification, j‚Äôouvre la console **`certtmpl.msc`** et je duplique le mod√®le **Authentification Kerberos** afin de cr√©er un mod√®le d√©di√© et ma√Ætris√©.

### üîß Param√©trage du mod√®le

- **Nom du mod√®le :** `Lab-DC-LDAPS`  
- **Compatibilit√© :** versions modernes de Windows  
- **Cryptographie :** fournisseur de stockage de cl√©s (KSP)  
- **S√©curit√© :**  
  - Groupe **Contr√¥leurs de domaine d'entreprise**  
  - Droits : **Lecture** et **Inscrire**

Ce mod√®le permettra aux DC d‚Äôobtenir automatiquement un certificat adapt√© √† l‚Äôusage LDAPS, sans modifier les mod√®les par d√©faut.

<div style="
  display: flex;
  justify-content: center;
  gap: 3rem;
  flex-wrap: wrap;
  margin: 2rem 0;
">

  <div style="
    display: flex;
    flex-direction: column;
    align-items: center;
    max-width: 700px;
    flex: 1 1 300px;
  ">
    <img src="/images/projets/win-identity-pro/ldaps/mmc1.png" alt="Ajout du composant Certificats" class="rounded-lg border border-white/10 shadow-md max-w-md w-full" />
    <p class="text-[0.65rem] italic opacity-50 mt-2 text-center">
      Ajout du composant Certificats dans MMC.
    </p>
  </div>

  <div style="
    display: flex;
    flex-direction: column;
    align-items: center;
    max-width: 700px;
    flex: 1 1 300px;">
    <img src="/images/projets/win-identity-pro/ldaps/mmc2.png" alt="S√©lection du compte ordinateur" class="rounded-lg border border-white/10 shadow-md max-w-md w-full" />
    <p class="text-[0.65rem] italic opacity-50 mt-2 text-center">
      S√©lection du compte ordinateur local.
    </p>
  </div>

</div>



---

## üìú √âtape 2 : Publication du mod√®le sur la CA

Une fois le mod√®le configur√©, il doit √™tre publi√© pour √™tre utilisable.

Dans **`certsrv.msc`** :

1. Clic droit sur **Mod√®les de certificats**
2. **Nouveau ‚Üí Mod√®le de certificat √† d√©livrer**
3. S√©lection du mod√®le **Lab-DC-LDAPS**

Le mod√®le est d√©sormais disponible pour l‚Äôenr√¥lement par les contr√¥leurs de domaine.

<div style="display: flex; justify-content: center; margin: 2rem 0;">
  <div style="display: flex; flex-direction: column; align-items: center; max-width: 700px;">
    <img src="/images/projets/win-identity-pro/ldaps/publier-modele.png" alt="Publication du mod√®le de certificat" class="rounded-lg border border-white/10 shadow-md max-w-md w-full" />
    <p class="text-[0.65rem] italic opacity-50 mt-2 text-center">Publication du mod√®le sur l‚Äôautorit√© de certification.</p>
  </div>
</div>

---

## üñ•Ô∏è √âtape 3 : Inscription manuelle du certificat sur le DC

Pour garder un contr√¥le pr√©cis dans ce lab, j‚Äôeffectue une **inscription manuelle** plut√¥t qu‚Äôun auto-enr√¥lement via GPO.

### üîß Ajout du composant Certificats

1. Lancer `mmc.exe`  
2. **Fichier ‚Üí Ajouter/Supprimer un composant logiciel enfichable**  
3. S√©lectionner **Certificats**  
4. Choisir **Compte d‚Äôordinateur**  
5. S√©lectionner **Ordinateur local**

<div style="display: flex; justify-content: center; gap: 3rem; flex-wrap: wrap; margin: 2rem 0;"> 

  <div style="display: flex; flex-direction: column; align-items: center; max-width: 700px;">
    <img src="/images/projets/win-identity-pro/ldaps/mmc1.png" alt="Ajout du composant Certificats" class="rounded-lg border border-white/10 shadow-md max-w-md w-full" />
    <p class="text-[0.65rem] italic opacity-50 mt-2 text-center">Ajout du composant Certificats dans MMC.</p>
  </div>
  <div style="display: flex; flex-direction: column; align-items: center; max-width: 700px;">
    <img src="/images/projets/win-identity-pro/ldaps/mmc2.png" alt="S√©lection du compte ordinateur" class="rounded-lg border border-white/10 shadow-md max-w-md w-full" />
    <p class="text-[0.65rem] italic opacity-50 mt-2 text-center">S√©lection du compte ordinateur local.</p>
  </div>
</div>


### üì• Demande du certificat

Dans **Certificats (ordinateur local)** :

1. Aller dans **Personnel ‚Üí Certificats**
2. Clic droit **Toutes les t√¢ches ‚Üí Demander un nouveau certificat**
3. S√©lectionner le mod√®le **Lab-DC-LDAPS**
4. Valider l‚Äôinscription

<div style="display: flex; justify-content: center; gap: 3rem; flex-wrap: wrap; margin: 2rem 0;">

  <div style="display: flex; flex-direction: column; align-items: center; max-width: 700px;">
    <img src="/images/projets/win-identity-pro/ldaps/mmc3.png" alt="Inscription du certificat LDAPS" class="rounded-lg border border-white/10 shadow-md max-w-md w-full" />
  </div>

  <div style="display: flex; flex-direction: column; align-items: center; max-width: 700px;">
    <img src="/images/projets/win-identity-pro/ldaps/mmc4.png" alt="Certificat LDAPS install√©" class="rounded-lg border border-white/10 shadow-md max-w-md w-full" />
  </div>

</div>

<p class="text-[0.65rem] italic opacity-50 mt-2 text-center">
  Le certificat LDAPS est install√© dans le magasin personnel du DC.
</p>


üîç Points de v√©rification :
- Le certificat contient l‚Äôusage **Authentification du serveur**

---

## üîç √âtape 4 : V√©rification de l‚Äô√©coute LDAPS

Une fois le certificat install√©, le service Active Directory active automatiquement LDAPS.  
Une v√©rification du syst√®me confirme que le DC √©coute bien sur le **port 636**.

<div style="display: flex; justify-content: center; margin: 2rem 0;">
  <div style="display: flex; flex-direction: column; align-items: center; max-width: 700px;">
    <img src="/images/projets/win-identity-pro/ldaps/netstat.png" alt="V√©rification port 636" class="rounded-lg border border-white/10 shadow-md max-w-md w-full" />
    <p class="text-[0.65rem] italic opacity-50 mt-2 text-center">Le contr√¥leur de domaine √©coute sur le port LDAPS.</p>
  </div>
</div>

En compl√©ment de l‚Äô√©coute locale du service, un test de connexion TCP permet de valider que le port 636 est r√©ellement accessible.

<div style="display: flex; justify-content: center; margin: 2rem 0;">
  <div style="display: flex; flex-direction: column; align-items: center; max-width: 700px;">
    <img src="/images/projets/win-identity-pro/ldaps/ldaps-tcp.png" alt="Test de connexion TCP vers le port 636" class="rounded-lg border border-white/10 shadow-md max-w-md w-full" /> 
    <p class="text-[0.65rem] italic opacity-50 mt-2 text-center">Test de connectivit√© TCP r√©ussi vers le port LDAPS.</p> 
  </div>
</div>

---

## üß™ √âtape 5 : Test fonctionnel avec LDP.exe

Pour valider le chiffrement r√©el du flux :

1. Lancer `ldp.exe`
2. **Connexion ‚Üí Se connecter**
3. Serveur : FQDN du DC  
4. Port : **636**  
5. Cocher **SSL**

L‚Äôaffichage du **RootDSE** confirme que la session LDAP est √©tablie via TLS.

<div style="display: flex; justify-content: center; margin: 2rem 0;">
  <div style="display: flex; flex-direction: column; align-items: center; max-width: 700px;">
    <img src="/images/projets/win-identity-pro/ldaps/mmc6.png" alt="Connexion LDAPS r√©ussie" class="rounded-lg border border-white/10 shadow-md max-w-md w-full" />
    <p class="text-[0.65rem] italic opacity-50 mt-2 text-center">Connexion LDAPS √©tablie avec succ√®s via TLS.</p>
  </div>
</div>

---

## üõ°Ô∏è √âtape 6 : Signature LDAP obligatoire (Durcissement)

LDAPS chiffre les communications sur le port 636.  
La **signature LDAP**, elle, prot√®ge l‚Äôint√©grit√© des √©changes sur le port 389.

Ces deux m√©canismes sont **compl√©mentaires** dans une strat√©gie de durcissement.

### üîí C√¥t√© contr√¥leurs de domaine

GPO :  
**Contr√¥leur de domaine : exigences de signature de serveur LDAP**  
‚Üí **Exiger la signature**

‚û°Ô∏è Le DC refuse les connexions LDAP simples non sign√©es.

### üíª C√¥t√© postes et serveurs membres

GPO :  
**S√©curit√© r√©seau : exigences de signature de client LDAP**  
‚Üí **Exiger la signature**

‚û°Ô∏è Les machines du domaine refusent de dialoguer avec un serveur LDAP ne supportant pas la signature.

<div style="display: flex; justify-content: center; margin: 2rem 0;">
  <div style="display: flex; flex-direction: column; align-items: center; max-width: 700px;">
    <img src="/images/projets/win-identity-pro/ldaps/gpo-ldap.png" alt="GPO Signature LDAP" class="rounded-lg border border-white/10 shadow-md max-w-md w-full" />
    <p class="text-[0.65rem] italic opacity-50 mt-2 text-center">Mise en place de la signature LDAP obligatoire via GPO.</p>
  </div>
</div>


L‚Äôannuaire communique d√©sormais via des canaux prot√©g√©s, garantissant la **confidentialit√©** et l‚Äô**int√©grit√©** des √©changes d‚Äôauthentification.

Cette √©tape marque la fin de la s√©curisation du socle d‚Äôidentit√©.  
La prochaine phase consistera √† renforcer la protection des comptes √† privil√®ges avec la mise en place d‚Äôune **authentification multifacteur (MFA)**.

<NextStep 
  href="/projets/client-domaine" 
  title="Joindre un client au domaine" 
/>
