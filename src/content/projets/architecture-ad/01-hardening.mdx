---
title: "Hardening Pr√©-Promotion"
description: "S√©curisation du syst√®me avant le d√©ploiement d'Active Directory"
category: "windows-server"
tags: ["Windows Server", "S√©curit√©", "ANSSI"]
pubDate: 2026-01-10
slug: "hardening-pre-promotion"
serie: "architecture-ad" 
serieOrder: 2
---
import SeriesStepper from '../../../components/SeriesStepper.astro';
import NextStep from '../../../components/NextStep.astro';

<div class="space-y-4">
  <p class="text-sm opacity-80 leading-relaxed">
    Installer l'AD ne suffit pas. Pour l'<strong>ANSSI</strong>, la s√©curit√© se joue avant la promotion. 
    Intervenir sur un serveur hors-domaine permet de neutraliser les vecteurs d'attaque h√©rit√©s avant qu'ils ne soient r√©pliqu√©s dans toute la for√™t.
  </p>
</div>

## üõ°Ô∏è Durcissement Pr√©-Promotion 

L'objectif est de r√©duire la surface d'attaque en d√©sactivant les protocoles de r√©solution de noms et de communication r√©seau h√©rit√©s, fr√©quemment exploit√©s lors des phases de compromission initiale.

### 1. D√©sactivation de LLMNR
LLMNR est un vecteur majeur d'interception de hashs NTLM. En l'absence de domaine et donc de GPO, l'intervention s'effectue directement dans le registre afin d'imposer la d√©sactivation.

En cas d'√©chec DNS, LLMNR diffuse la requ√™te en clair sur le r√©seau local, ce qui permet √† un attaquant de capturer et relayer des identifiants via des attaques de type *Man-in-the-Middle*.

<div class="grid grid-cols-1 md:grid-cols-2 gap-4 my-8">
  <div class="flex flex-col items-center">
    <img src="/images/projets/architecture-ad/promo/llmnr-desactived.png" alt="D√©sactivation LLMNR" class="rounded-lg border border-white/10 w-full shadow-md" />
    <p class="text-[0.65rem] italic opacity-50 mt-2">Cr√©ation de la cl√© de registre EnableMulticast</p>
  </div>
  <div class="flex flex-col items-center">
    <img src="/images/projets/architecture-ad/promo/llmnr-verif-0.png" alt="V√©rification LLMNR" class="rounded-lg border border-white/10 w-full shadow-md" />
    <p class="text-[0.65rem] italic opacity-50 mt-2">V√©rification : Valeur positionn√©e √† 0 (D√©sactiv√©)</p>
  </div>
</div>

### 2. D√©sactivation de SMBv1
Protocole historique d√©sormais obsol√®te, SMBv1 est d√©pourvu de m√©canismes de s√©curit√© modernes. Il a notamment √©t√© utilis√© comme vecteur de propagation lors d‚Äôattaques massives telles que WannaCry.

Dans ce cas pr√©cis, la fonctionnalit√© **SMB 1.0/CIFS** n‚Äôest pas install√©e sur le syst√®me : le protocole est donc d√©j√† absent, ce qui confirme une configuration conforme aux standards de s√©curit√© actuels.

<div class="flex flex-col items-center my-8">
  <img src="/images/projets/architecture-ad/promo/smb1-desactived.png" alt="D√©sactivation SMBv1" class="max-w-[350px] w-full rounded-lg border border-white/10 shadow-md" />
  <p class="text-[0.65rem] italic opacity-50 mt-2">V√©rification de l'√©tat du r√¥le : Available (Non install√©)</p>
</div>

### 3. D√©sactivation de NetBIOS
<div class="space-y-4">
    <p class="text-sm opacity-80 leading-relaxed">
      NetBIOS est un protocole "bavard" : il diffuse inutilement le nom du serveur et ses m√©tadonn√©es sur le segment r√©seau. 
      C'est un cadeau pour un attaquant en phase de reconnaissance.
    </p>
    <div class="bg-white/5 border-l-2 border-blue-500 p-4 rounded-r-lg">
      <p class="text-xs opacity-70 italic">
        "Sa d√©sactivation est un pr√©requis indispensable avant l'introduction du serveur dans l'Active Directory."
      </p>
    </div>
  </div>

<div class="grid grid-cols-1 sm:grid-cols-3 gap-4 my-8">
  <img src="/images/projets/architecture-ad/promo/netbios-active.png" alt="√âtat initial" class="rounded-lg border border-white/10 w-full" />
  <img src="/images/projets/architecture-ad/promo/netbios-desactived.png" alt="Script d√©sactivation" class="rounded-lg border border-white/10 w-full" />
  <img src="/images/projets/architecture-ad/promo/netbios-verif.png" alt="Audit final" class="rounded-lg border border-white/10 w-full" />
</div>

---

## V√©rifications

Apr√®s red√©marrage, une v√©rification rapide via `netstat` permet de confirmer l‚Äô√©tat du serveur.  
Seuls les services strictement n√©cessaires au r√¥le futur (DNS, SMB, RPC) sont en √©coute.

<div style="display: flex; justify-content: center; margin: 2rem 0;">
  <div style="display: flex; flex-direction: column; align-items: center; max-width: 500px;">
    <img src="/images/projets/architecture-ad/promo/netstat.png" alt="Param√®tres NetBIOS via IPv4 avanc√©" style="width: 100%; height: auto; border-radius: 10px; border: 1px solid rgba(255,255,255,0.1);" />
    <p style="font-size: 0.65rem; text-align: center; opacity: 0.5; margin-top: 8px; font-style: italic;">Acc√®s aux param√®tres avanc√©s NetBIOS via les propri√©t√©s IPv4</p>
  </div>
</div>

<section class="mt-16 space-y-12">
  
  <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-center bg-white/5 border border-white/10 rounded-2xl p-8">
    <div>
      <h3 class="text-xl font-bold mb-4 flex items-center gap-2">
        <span class="text-green-400">‚úÖ</span> Bilan de l'√©tape 02
      </h3>
      <ul class="space-y-3">
        <li class="flex items-start gap-3 text-sm opacity-80">
          <span><strong>Surface d'attaque r√©duite :</strong> Protocoles h√©rit√©s (LLMNR, NetBIOS) d√©sactiv√©s.</span>
        </li>
        <li class="flex items-start gap-3 text-sm opacity-80">
          <span><strong>Conformit√© :</strong> Absence de SMBv1 confirm√©e pour pr√©venir les ransomwares.</span>
        </li>
        <li class="flex items-start gap-3 text-sm opacity-80">
          <span><strong>Serveur "Sain" :</strong> Seuls les flux critiques sont en √©coute (Audit netstat).</span>
        </li>
      </ul>
    </div>
    
    <div class="hidden md:flex justify-center border-l border-white/10 pl-8">
        <div class="text-center">
          <div class="text-4xl mb-2">üõ°Ô∏è</div>
          <p class="text-[10px] uppercase tracking-tighter opacity-40 font-bold">Syst√®me Durci</p>
        </div>
    </div>
  </div>

  <div class="max-w-2xl mx-auto text-center space-y-4">
    <p class="text-base leading-relaxed opacity-90 italic">
      "Le durcissement du syst√®me d'exploitation est la premi√®re ligne de d√©fense. Un contr√¥leur de domaine ne peut √™tre plus s√ªr que l'OS qui l'h√©berge."
    </p>
  </div>

</section>

<NextStep 
  href="/projets/promotion-domaine" 
  title="Promotion du domaine" 
/>
