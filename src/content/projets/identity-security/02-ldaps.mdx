---
title: "LDAPS : Chiffrement et audit des flux d'annuaire"
description: "SÃ©curisation des accÃ¨s LDAP via TLS et mise en place d'un audit de signature pour durcir l'infrastructure Active Directory."
tags: ["Active Directory", "Windows Server", "SÃ©curitÃ©", "LDAPS", "Audit"]
pubDate: 2026-02-05
serie: "identity-security"
serieOrder: 3
category: "windows-server"
slug: "ldaps"
---

import SeriesStepper from '../../../components/SeriesStepper.astro';
import NextStep from '../../../components/NextStep.astro';


Par dÃ©faut, certaines requÃªtes LDAP peuvent circuler en clair sur le rÃ©seau via le port **389**, notamment lors dâ€™un *simple bind*.  
LDAP peut toutefois Ãªtre sÃ©curisÃ© soit par **StartTLS**, soit par **signature LDAP**.

Dans ce lab, nous choisissons dâ€™implÃ©menter **LDAPS (port 636)** afin de disposer dâ€™un canal chiffrÃ© explicite et facilement vÃ©rifiable.

> ğŸ¯ Objectif du lab  
> Ce projet sâ€™inscrit dans une dÃ©marche de **durcissement volontaire** du socle Active Directory.  
> Certaines configurations appliquÃ©es ici seraient prÃ©cÃ©dÃ©es dâ€™une phase dâ€™audit et de compatibilitÃ© en production.

Les risques dâ€™un LDAP non sÃ©curisÃ© incluent :

- lâ€™exposition dâ€™identifiants  
- la divulgation dâ€™informations dâ€™annuaire  
- lâ€™interception ou la modification de requÃªtes dâ€™authentification  

Dans une infrastructure durcie suivant les recommandations de lâ€™**ANSSI**, ces Ã©changes doivent impÃ©rativement Ãªtre protÃ©gÃ©s.

Le passage au **LDAPS (LDAP over TLS â€“ port 636)** permet dâ€™assurer la confidentialitÃ© des communications.  
Cette sÃ©curisation repose directement sur :

- la **PKI interne** dÃ©ployÃ©e prÃ©cÃ©demment  
- la **cohÃ©rence DNS**, nÃ©cessaire Ã  la validation du certificat du contrÃ´leur de domaine  

LDAPS nÃ©cessite la prÃ©sence dâ€™au moins un certificat valide contenant lâ€™usage **Authentification du serveur** dans le magasin ordinateur du contrÃ´leur de domaine.  
Dans ce lab, nous gÃ©rons explicitement ce certificat afin de maÃ®triser le fonctionnement du service.


## ğŸ› ï¸ Ã‰tape 1 : CrÃ©ation du modÃ¨le de certificat "Lab-DC-LDAPS"

Dans un environnement rÃ©el, Active Directory fonctionne dÃ©jÃ  sans LDAPS obligatoire.  
Ici, nous forÃ§ons volontairement la configuration afin dâ€™observer les mÃ©canismes de sÃ©curisation des flux dâ€™annuaire.

Pour que LDAPS soit activÃ©, le contrÃ´leur de domaine doit disposer dâ€™un certificat contenant lâ€™usage **Authentification du serveur**.

Sur lâ€™autoritÃ© de certification, jâ€™ouvre la console **`certtmpl.msc`** et je duplique le modÃ¨le **Authentification Kerberos** afin de crÃ©er un modÃ¨le dÃ©diÃ© et maÃ®trisÃ©.

### ğŸ”§ ParamÃ©trage du modÃ¨le

<div class="grid grid-cols-1 md:grid-cols-3 gap-6 my-10">

  <div style="background-color: var(--card-bg); border: 1px solid var(--card-border);" class="p-5 rounded-2xl shadow-sm">
    <p style="color: var(--text-purple);" class="text-[10px] font-black uppercase tracking-widest mb-3">Identification</p>
    <ul class="space-y-2 text-sm" style="color: var(--text-main);">
      <li><strong>Nom :</strong> <code style="color: var(--text-purple);">Lab-DC-LDAPS</code></li>
      <li><strong>CompatibilitÃ© :</strong> Windows 2016+</li>
    </ul>
  </div>

  <div style="background-color: var(--card-bg); border: 1px solid var(--card-border);" class="p-5 rounded-2xl shadow-sm">
    <p style="color: var(--text-purple);" class="text-[10px] font-black uppercase tracking-widest mb-3">Cryptographie</p>
    <ul class="space-y-2 text-sm" style="color: var(--text-main);">
      <li><strong>Fournisseur :</strong> KSP (Key Storage)</li>
      <li><strong>Usage :</strong> Authentification Serveur</li>
    </ul>
  </div>

  <div style="background-color: var(--card-bg); border: 1px solid var(--card-border);" class="p-5 rounded-2xl shadow-sm">
    <p style="color: #107c10;" class="text-[10px] font-black uppercase tracking-widest mb-3">Permissions</p>
    <div class="flex gap-2">
      <span class="bg-green-500/10 text-green-600 dark:text-green-400 px-2 py-1 rounded text-[10px] font-bold">Lecture</span>
      <span class="bg-green-500/10 text-green-600 dark:text-green-400 px-2 py-1 rounded text-[10px] font-bold">Inscrire</span>
    </div>
    <p class="text-[9px] mt-3 opacity-60" style="color: var(--text-main);">Cible : ContrÃ´leurs de domaine d'entreprise</p>
  </div>

</div>

> Ce modÃ¨le permet aux contrÃ´leurs de domaine (DC) dâ€™obtenir automatiquement un certificat adaptÃ© au LDAPS sans impacter les paramÃ¨tres par dÃ©faut de la forÃªt.

<div style="
  display: flex;
  justify-content: center;
  gap: 3rem;
  flex-wrap: wrap;
  margin: 2rem 0;
">

  <div style="
    display: flex;
    flex-direction: column;
    align-items: center;
    max-width: 700px;
    flex: 1 1 300px;
  ">
    <img src="/images/projets/identity-security/ldaps/mmc1.png" alt="Ajout du composant Certificats" class="rounded-lg border border-white/10 shadow-md max-w-md w-full" />
    <p class="text-[0.65rem] italic opacity-50 mt-2 text-center">Ajout du composant Certificats dans MMC.</p>
  </div>

  <div style="
    display: flex;
    flex-direction: column;
    align-items: center;
    max-width: 700px;
    flex: 1 1 300px;">
    <img src="/images/projets/identity-security/ldaps/mmc2.png" alt="SÃ©lection du compte ordinateur" class="rounded-lg border border-white/10 shadow-md max-w-md w-full" />
    <p class="text-[0.65rem] italic opacity-50 mt-2 text-center">SÃ©lection du compte ordinateur local.</p>
  </div>

</div>

---

## ğŸ“œ Ã‰tape 2 : Publication du modÃ¨le sur la CA

Une fois le modÃ¨le configurÃ©, il doit Ãªtre publiÃ© pour Ãªtre utilisable.

Dans **`certsrv.msc`** :

1. Clic droit sur **ModÃ¨les de certificats**
2. **Nouveau â†’ ModÃ¨le de certificat Ã  dÃ©livrer**
3. SÃ©lection du modÃ¨le **Lab-DC-LDAPS**

Le modÃ¨le est dÃ©sormais disponible pour lâ€™enrÃ´lement par les contrÃ´leurs de domaine.

<div style="display: flex; justify-content: center; margin: 2rem 0;">
  <div style="display: flex; flex-direction: column; align-items: center; max-width: 700px;">
    <img src="/images/projets/identity-security/ldaps/publier-modele.png" alt="Publication du modÃ¨le de certificat" class="rounded-lg border border-white/10 shadow-md max-w-md w-full" />
    <p class="text-[0.65rem] italic opacity-50 mt-2 text-center">Publication du modÃ¨le sur lâ€™autoritÃ© de certification.</p>
  </div>
</div>

---

## ğŸ–¥ï¸ Ã‰tape 3 : Inscription manuelle du certificat sur le DC

Pour garder un contrÃ´le prÃ©cis dans ce lab, jâ€™effectue une **inscription manuelle** plutÃ´t quâ€™un auto-enrÃ´lement via GPO.

### ğŸ”§ Ajout du composant Certificats

1. Lancer `mmc.exe`  
2. **Fichier â†’ Ajouter/Supprimer un composant logiciel enfichable**  
3. SÃ©lectionner **Certificats**  
4. Choisir **Compte dâ€™ordinateur**  
5. SÃ©lectionner **Ordinateur local**

<div style="display: flex; justify-content: center; gap: 3rem; flex-wrap: wrap; margin: 2rem 0;"> 

  <div style="display: flex; flex-direction: column; align-items: center; max-width: 700px;">
    <img src="/images/projets/identity-security/ldaps/mmc1.png" alt="Ajout du composant Certificats" class="rounded-lg border border-white/10 shadow-md max-w-md w-full" />
    <p class="text-[0.65rem] italic opacity-50 mt-2 text-center">Ajout du composant Certificats dans MMC.</p>
  </div>
  <div style="display: flex; flex-direction: column; align-items: center; max-width: 700px;">
    <img src="/images/projets/identity-security/ldaps/mmc2.png" alt="SÃ©lection du compte ordinateur" class="rounded-lg border border-white/10 shadow-md max-w-md w-full" />
    <p class="text-[0.65rem] italic opacity-50 mt-2 text-center">SÃ©lection du compte ordinateur local.</p>
  </div>
</div>


### ğŸ“¥ Demande du certificat

Dans **Certificats (ordinateur local)** :

1. Aller dans **Personnel â†’ Certificats**
2. Clic droit **Toutes les tÃ¢ches â†’ Demander un nouveau certificat**
3. SÃ©lectionner le modÃ¨le **Lab-DC-LDAPS**
4. Valider lâ€™inscription

<div style="display: flex; justify-content: center; gap: 3rem; flex-wrap: wrap; margin: 2rem 0;">

  <div style="display: flex; flex-direction: column; align-items: center; max-width: 700px;">
    <img src="/images/projets/identity-security/ldaps/mmc3.png" alt="Inscription du certificat LDAPS" class="rounded-lg border border-white/10 shadow-md max-w-md w-full" />
  </div>

  <div style="display: flex; flex-direction: column; align-items: center; max-width: 700px;">
    <img src="/images/projets/identity-security/ldaps/mmc4.png" alt="Certificat LDAPS installÃ©" class="rounded-lg border border-white/10 shadow-md max-w-md w-full" />
  </div>

</div>

<p class="text-[0.65rem] italic opacity-50 mt-2 text-center">
  Le certificat LDAPS est installÃ© dans le magasin personnel du DC.
</p>


ğŸ” Points de vÃ©rification :
- Le certificat contient lâ€™usage **Authentification du serveur**

---

## ğŸ” Ã‰tape 4 : VÃ©rification de lâ€™Ã©coute LDAPS

Une fois le certificat installÃ©, le service Active Directory active automatiquement LDAPS.  
Une vÃ©rification du systÃ¨me confirme que le DC Ã©coute bien sur le **port 636**.

<div style="display: flex; justify-content: center; margin: 2rem 0;">
  <div style="display: flex; flex-direction: column; align-items: center; max-width: 700px;">
    <img src="/images/projets/identity-security/ldaps/netstat.png" alt="VÃ©rification port 636" class="rounded-lg border border-white/10 shadow-md max-w-md w-full" />
    <p class="text-[0.65rem] italic opacity-50 mt-2 text-center">Le contrÃ´leur de domaine Ã©coute sur le port LDAPS.</p>
  </div>
</div>

En complÃ©ment de lâ€™Ã©coute locale du service, un test de connexion TCP permet de valider que le port 636 est rÃ©ellement accessible.

<div style="display: flex; justify-content: center; margin: 2rem 0;">
  <div style="display: flex; flex-direction: column; align-items: center; max-width: 700px;">
    <img src="/images/projets/identity-security/ldaps/ldaps-tcp.png" alt="Test de connexion TCP vers le port 636" class="rounded-lg border border-white/10 shadow-md max-w-md w-full" /> 
    <p class="text-[0.65rem] italic opacity-50 mt-2 text-center">Test de connectivitÃ© TCP rÃ©ussi vers le port LDAPS.</p> 
  </div>
</div>

---

## ğŸ§ª Ã‰tape 5 : Test fonctionnel avec LDP.exe

Pour valider le chiffrement rÃ©el du flux :

1. Lancer `ldp.exe`
2. **Connexion â†’ Se connecter**
3. Serveur : FQDN du DC  
4. Port : **636**  
5. Cocher **SSL**

Lâ€™affichage du **RootDSE** confirme que la session LDAP est Ã©tablie via TLS.

<div style="display: flex; justify-content: center; margin: 2rem 0;">
  <div style="display: flex; flex-direction: column; align-items: center; max-width: 700px;">
    <img src="/images/projets/identity-security/ldaps/mmc6.png" alt="Connexion LDAPS rÃ©ussie" class="rounded-lg border border-white/10 shadow-md max-w-md w-full" />
    <p class="text-[0.65rem] italic opacity-50 mt-2 text-center">Connexion LDAPS Ã©tablie avec succÃ¨s via TLS.</p>
  </div>
</div>

---

## ğŸ›¡ï¸ Ã‰tape 6 : Signature LDAP obligatoire (Durcissement)

<div style="border-left: 4px solid #ef4444; background-color: var(--card-bg);" class="p-6 my-10 rounded-r-2xl shadow-sm border border-slate-200 dark:border-white/5">
  <h4 class="text-red-600 dark:text-red-400 text-xs font-black uppercase tracking-widest mb-4 flex items-center gap-2">
    ğŸ›¡ï¸ Recommandation ANSSI : Signature Obligatoire
  </h4>
  <p class="text-sm leading-relaxed mb-4" style="color: var(--text-main);">
    Le simple chiffrement LDAPS ne suffit pas Ã  protÃ©ger l'intÃ©gralitÃ© du trafic. En forÃ§ant la <strong>signature LDAP</strong>, on neutralise les attaques de type <em>Relay</em> et <em>Man-in-the-Middle</em> sur le port 389.
  </p>
  <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
    <div class="p-3 bg-white/5 rounded-xl border border-white/5">
      <p class="text-[10px] font-bold opacity-50 uppercase mb-1">CÃ´tÃ© DC</p>
      <p class="text-[11px]" style="color: var(--text-main);">Refus des binds simples non signÃ©s.</p>
    </div>
    <div class="p-3 bg-white/5 rounded-xl border border-white/5">
      <p class="text-[10px] font-bold opacity-50 uppercase mb-1">CÃ´tÃ© Clients</p>
      <p class="text-[11px]" style="color: var(--text-main);">Exigence de signature pour toute requÃªte.</p>
    </div>
  </div>
</div>

<div style="display: flex; justify-content: center; margin: 2rem 0;">
  <div style="display: flex; flex-direction: column; align-items: center; max-width: 700px;">
    <img src="/images/projets/identity-security/ldaps/gpo-ldap.png" alt="GPO Signature LDAP" class="rounded-lg border border-white/10 shadow-md max-w-md w-full" />
    <p class="text-[0.65rem] italic opacity-50 mt-2 text-center">Mise en place de la signature LDAP obligatoire via GPO.</p>
  </div>
</div>



Ce niveau de restriction correspond Ã  une politique de durcissement volontaire.  
En production, cette configuration serait prÃ©cÃ©dÃ©e dâ€™une phase dâ€™audit afin dâ€™identifier les applications hÃ©ritÃ©es.

Cette Ã©tape marque la fin de la sÃ©curisation du socle dâ€™identitÃ©.


<section class="mt-16 space-y-12">
  
  <div style="background-color: var(--card-bg); border: 1px solid var(--card-border);" class="grid grid-cols-1 md:grid-cols-2 gap-8 items-center rounded-2xl p-8 shadow-sm">
    <div>
      <h3 style="color: var(--text-title);" class="text-xl font-black mb-4 flex items-center gap-2">
        <span class="text-green-500 text-lg">âœ…</span> Bilan de l'Ã©tape : LDAPS
      </h3>
      <ul class="space-y-3">
        <li class="flex items-start gap-3 text-sm" style="color: var(--text-main);">
          <span><strong>Chiffrement actif :</strong> Port <code style="color: var(--text-purple);">636</code> ouvert et sÃ©curisÃ© via certificat RSA/SHA.</span>
        </li>
        <li class="flex items-start gap-3 text-sm" style="color: var(--text-main);">
          <span><strong>IntÃ©gritÃ© :</strong> Signature LDAP forcÃ©e, interdisant la circulation des identifiants en clair.</span>
        </li>
        <li class="flex items-start gap-3 text-sm" style="color: var(--text-main);">
          <span><strong>Audit :</strong> Flux validÃ©s via <code style="color: var(--text-purple);">ldp.exe</code> et vÃ©rification d'Ã©coute rÃ©seau.</span>
        </li>
      </ul>
    </div>
    
    <div style="border-color: var(--card-border);" class="flex justify-center border-t pt-8 md:border-t-0 md:border-l md:pl-8 md:pt-0">
        <div class="text-center">
          <div class="text-5xl mb-2 transition-transform hover:scale-110 duration-300">ğŸ”’</div>
          <p style="color: var(--text-title);" class="text-[10px] uppercase tracking-[0.2em] font-black opacity-60">Tunnel SSL Ã©tabli</p>
          <p style="color: var(--text-muted);" class="text-[9px] mt-1 italic">Flux d'annuaire durcis</p>
        </div>
    </div>
  </div>

  <div class="max-w-2xl mx-auto text-center space-y-6 px-4">
    <p style="color: var(--text-main);" class="text-base leading-relaxed italic opacity-90">
      "En activant le LDAPS, nous sÃ©curisons le cÅ“ur de notre identitÃ© numÃ©rique. Chaque requÃªte entre nos serveurs et nos clients est dÃ©sormais encapsulÃ©e dans un tunnel de confiance."
    </p>
    
    <div style="background-color: var(--purple-border);" class="h-px w-24 mx-auto"></div>

    <div class="space-y-2">
      <p style="color: var(--text-muted);" class="text-sm">
        <strong>Objectif suivant :</strong> Administration granulaire, dÃ©ploiement de la hiÃ©rarchie d'<strong>UnitÃ©s d'Organisation (OU)</strong> et gestion des accÃ¨s.
      </p>
    </div>
  </div>

</section>

<NextStep 
  href="/projets/ou" 
  title="OUs et HiÃ©rarchie" 
/>
