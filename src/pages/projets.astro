---
import { getCollection } from 'astro:content';
import Layout from '../layouts/Layout.astro';

const projects = await getCollection('projets');
const sortedProjects = projects.sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());
---

<Layout>
  <h1 class="text-4xl font-bold mb-12 text-white tracking-tighter">Mes Travaux</h1>
  
  <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
    {sortedProjects.map((project) => (
      <a href={`/projets/${project.slug}`} class="group relative flex flex-col justify-between p-6 min-h-[280px] rounded-[1.5rem] bg-[#23262d] border border-[#343841] hover:border-purple-400/50 shadow-xl transition-all duration-300">
          
          <div class="space-y-4 relative z-10">
              <div class="flex flex-wrap gap-2">
                  {project.data.tags.map(tag => (
                      <span class="px-2 py-0.5 text-[9px] font-bold uppercase tracking-widest bg-[#13151a] text-purple-300 rounded-md border border-purple-500/20">
                          {tag}
                      </span>
                  ))}
              </div>
              
              <h3 class="text-xl font-bold text-white group-hover:text-purple-300 transition-colors leading-tight">
                  {project.data.title}
              </h3>
              
              <p class="text-zinc-400 text-sm leading-relaxed line-clamp-3">
                  {project.data.description}
              </p>
          </div>

          <div class="self-end relative z-10 text-zinc-600 group-hover:text-white transition-colors">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="7" y1="17" x2="17" y2="7"></line><polyline points="7 7 17 7 17 17"></polyline></svg>
          </div>

          <div class="absolute inset-0 rounded-[1.5rem] ring-1 ring-inset ring-white/5 group-hover:ring-purple-400/20 transition-all"></div>
      </a>
    ))}
  </div>
</Layout>