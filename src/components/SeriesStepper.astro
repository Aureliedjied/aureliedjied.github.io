---
interface Step {
  label: string;
  href: string;
}

interface Props {
  steps: Step[];
  currentStepIndex: number;
  seriesTitle: string;
}

const { steps, currentStepIndex, seriesTitle } = Astro.props;
---

<nav class="my-10 w-full" aria-label="Progression du labo">
  <div class="mb-4 px-1 flex items-center gap-3">
    <h4 class="text-[10px] uppercase tracking-[0.2em] font-black italic" style="color: var(--text-muted)">
      {seriesTitle}
    </h4>
    <div class="h-px flex-1 opacity-10" style="background-color: var(--text-main)"></div>
  </div>

  <div class="grid grid-cols-1 sm:flex sm:flex-wrap gap-3">
    {steps.map((step, index) => {
      const isCurrent = index === currentStepIndex;
      
      return (
        <a 
          href={step.href}
          class={`group flex items-center gap-4 px-4 py-3 rounded-xl border transition-all duration-300 min-w-fit flex-1 sm:flex-none ${
            isCurrent 
              ? "shadow-lg shadow-purple-500/25" 
              : ""
          }`}
          style={isCurrent 
            ? "background-color: #9333ea; border-color: #a855f7; color: #ffffff !important;" 
            : "background-color: var(--card-bg); border-color: var(--card-border); color: var(--text-main);"
          }
        >
          <span 
            class="flex-shrink-0 flex items-center justify-center w-6 h-6 rounded-md text-[10px] font-black font-mono border"
            style={isCurrent 
              ? "background-color: rgba(0,0,0,0.2); border-color: rgba(255,255,255,0.2); color: #ffffff;" 
              : "background-color: var(--bg-color); border-color: var(--card-border); opacity: 0.5;"
            }
          >
            {String(index + 1).padStart(2, '0')}
          </span>

          <span class="text-[13px] font-bold tracking-tight"
                style={isCurrent ? "color: #ffffff !important;" : "color: var(--text-title)"}>
            {step.label}
          </span>

          {isCurrent && (
            <span class="ml-auto flex h-2 w-2 rounded-full bg-white animate-pulse"></span>
          )}
        </a>
      )
    })}
  </div>
</nav>

<style>
  /* Hover pour les boutons inactifs uniquement */
  a:not([style*="background-color: #9333ea"]):hover {
    border-color: #9333ea !important;
    transform: translateY(-2px);
    background-color: var(--bg-glow-1) !important;
  }

  /* Force le blanc sur le texte du bouton actif même si le global essaie de l'écraser */
  a[style*="background-color: #9333ea"] span {
    color: #ffffff !important;
  }
</style>