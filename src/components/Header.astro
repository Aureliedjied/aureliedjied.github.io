---
import ThemeIcon from './ThemeIcon.astro';

const { pathname } = Astro.url;
const activeClass = "bg-purple-500/10 text-purple-600 dark:text-purple-400 font-bold";
---

<header class="flex items-center justify-between py-4 sm:py-6 px-4 border-b transition-colors duration-300 sticky top-0 z-50 backdrop-blur-md" 
        style="border-color: var(--card-border); background-color: var(--header-bg);">
  
  {/* LOGO : On réduit un peu la marge sur mobile */}
  <a href="/" class="hidden md:block font-black tracking-tighter text-xl hover:text-purple-500 transition-colors shrink-0 mr-4" style="color: var(--text-title);">
    AURELIE<span class="text-purple-500">.</span>DJIED
  </a>
  
  <a href="/" class="md:hidden font-black tracking-tighter text-xl text-purple-500 shrink-0 mr-2">
    AD<span style="color: var(--text-title);">.</span>
  </a>

  {/* NAV : On utilise gap-1 sur mobile pour gagner de la place */}
  <nav class="flex items-center gap-1 sm:gap-4 overflow-hidden">
    <div class="flex items-center gap-0.5 sm:gap-1">
      <ThemeIcon />

      <a href="/" class={`nav-link px-2.5 py-2 rounded-full text-[11px] sm:text-sm transition-all ${pathname === "/" ? activeClass : ""}`}>
        Accueil
      </a>
      <a href="/projets" class={`nav-link px-2.5 py-2 rounded-full text-[11px] sm:text-sm transition-all ${pathname.includes("/projets") ? activeClass : ""}`}>
        Projets
      </a>
      <a href="/presentation" class={`nav-link px-2.5 py-2 rounded-full text-[11px] sm:text-sm transition-all whitespace-nowrap ${pathname === "/presentation" ? activeClass : ""}`}>
        <span class="sm:hidden">Bio</span>
        <span class="hidden sm:inline">Qui suis-je</span>
      </a>
      <a href="/contact" class={`nav-link px-2.5 py-2 rounded-full text-[11px] sm:text-sm transition-all ${pathname === "/contact" ? activeClass : ""}`}>
        Contact
      </a>
    </div>
    
    <div class="h-6 w-px bg-slate-200 dark:bg-white/10 mx-1 hidden xs:block"></div>

    <a 
      href="/recherche" 
      class={`search-btn p-2 rounded-full border transition-all shadow-sm shrink-0 ${pathname === "/recherche" ? "border-purple-500 text-purple-500" : ""}`}
      aria-label="Rechercher"
    >
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" class="sm:w-[18px] sm:h-[18px]">
        <circle cx="11" cy="11" r="8"></circle>
        <path d="m21 21-4.3-4.3"></path>
      </svg>
    </a>
  </nav>
</header>

<style is:global>
  /* On s'assure que le header ne dépasse jamais 100% de la largeur */
  header {
    max-width: 100vw;
    box-sizing: border-box;
  }

  .nav-link {
    color: var(--text-main);
    font-weight: 600;
  }
  
  /* Ajustement de la taille de texte pour les très petits écrans (iPhone SE, etc.) */
  @media (max-width: 380px) {
    .nav-link {
      padding-left: 0.5rem;
      padding-right: 0.5rem;
      font-size: 10px;
    }
  }

  .nav-link {
    color: var(--text-main);
    font-weight: 600;
  }

  .nav-link:hover {
    color: var(--text-purple) !important;
    background-color: var(--bg-glow-1);
  }

  .search-btn {
    background-color: var(--card-bg);
    border-color: var(--card-border);
    color: var(--text-main);
  }

  .search-btn:hover {
    color: #a855f7 !important;
    border-color: #a855f7 !important;
    background-color: rgba(168, 85, 247, 0.05);
    transform: translateY(-1px);
  }
</style>